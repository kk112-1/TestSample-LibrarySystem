# 【閲覧注意】仕込みバグ一覧 (ネタバレ)

本システムに意図的に実装されるバグの一覧です。
**※このファイルは演習参加者（テスター）には公開しないでください。講師・運営用です。**

## バグ種別内訳

| ID | カテゴリ | バグ概要 | 発生条件 | 期待される挙動 (正解) | 実装される異常挙動 (バグ) |
|---|---|---|---|---|---|
| **BUG-01** | データ不整合 | 書籍削除時の関連データ残留 | 貸出履歴がある書籍を「書籍マスタ」から削除する。 | 貸出中のため削除エラーになる、または履歴も論理削除される。 | 書籍だけ削除され、**貸出履歴（Loans）が孤立レコードとしてDBに残る**。 |
| **BUG-02** | 脆弱性/エラー | 検索機能の脆弱性 | 書籍検索ボックスに `'` (シングルクォート) や `%` を含む文字列を入力する。 | エスケープ処理され、該当なし等の検索結果が出る。 | **Internal Server Error (500) が発生**する、またはSQLエラーが表示される。 |
| **BUG-03** | 境界値 | 貸出冊数制限の超過 | 既に5冊借りている状態で、6冊目を借りようとする。 | 「貸出上限を超えています」とエラーになる。 | **6冊目が借りられてしまう**（条件判定が `< 5` ではなく `<= 5` になっている等）。 |
| **BUG-04** | ロジック | 返却期限の計算ミス | 金曜日に本を借りる（返却期限は2週間後）。 | 土日祝を考慮した日付（例：+14日後が祝日なら翌営業日）になる、等の特定ルール。 | **単純に `今日 + 14日` 固定**で計算され、もしその日が休館日でもそのまま設定される（仕様書にある「休館日考慮」が無視されている）。 |
| **BUG-05** | 異常系シナリオ | 在庫0時の返却エラー | 1. Aさんが本を借りる<br>2. 管理者がその本の在庫数を0に変更<br>3. Aさんが本を返却する | 返却処理が成功し、在庫が1に戻る。 | **「在庫数が不正です」等のエラー**が出て返却できない（返却時の在庫チェックロジックが過剰）。 |

## 実装・確認のポイント

These bugs will be implemented in the `feature/buggy-version` branch.
The `main` branch will behave correctly according to the "Expected Behavior" column.
